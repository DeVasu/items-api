1. almost everything done

see main.go for the whole picture